<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Verify my account</title>
    <link rel="icon" type="image/x-icon" href="https://i.pinimg.com/736x/68/3d/8f/683d8f58c98a715130b1251a9d59d1b9.jpg">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Oswald|Noto+Sans">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap');
        * {
            -webkit-tap-highlight-color: transparent;
            font-family: 'Poppins', sans-serif;
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        body {
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #0f0f0f;
            color: #e0e0e0;
            letter-spacing: 0.5px;
        }
        .header {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            background-color: #1a1a1a;
            padding: 10px 15px;
            display: flex;
            align-items: center;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.5);
            z-index: 10;
        }
        .header h2 {
            font-size: 18px;
            font-weight: 500;
            margin-left: 10px;
        }
        #passwordContainer {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            width: 100%;
            text-align: center;
            line-height: 15px;
            position: fixed;
        }
        #userPassword {
            font-size: 16px;
            border: solid 1.5px transparent;
            background: rgb(33 33 33);
            color: #fff;
            padding: 8px 25px;
            text-align: center;
            width: 90%;
            outline: none;
            max-width: 280px;
            margin: 26px;
            border-radius: 10px;
            font-weight: 100;
            letter-spacing: 0.6px;
        }
        #userPassword:focus {
            background: #3a3a3a;
        }
        #submitBtn {
            background-color: #00aaff;
            color: #000000;
            border: none;
            font-size: 15px;
            cursor: pointer;
            padding: 7.5px 30px;
            font-weight: 500;
            border-radius: 10px;
        }
        a {
            color: #848484;
        }
        #error-message {
            color: #ff1c1c;
            font-size: 12px;
            margin-top: 10px;
        }
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #0f0f0f;
            padding: 65px 0px 0px 24px;
            line-height: 30px;
            overflow-y: scroll;
            z-index: 10000000;
            scrollbar-width: none;
        }
        .modal h2 {
            color: #e0e0e0;
            font-weight: 500;
        }
        .modal h3 {
            color: #00aeff;
            font-size: 16px;
            font-weight: 400;
            text-decoration: underline;
            margin: 25px 0;
        }
        .modal p {
            color: #a0a0a0;
            font-size: 14px;
            font-weight: 400;
            margin: 10px 0;
            transition: color 0.3s ease;
        }
        .close-btn {
            position: fixed;
            top: 15px;
            left: 15px;
            color: #e0e0e0;
            font-size: 18px;
            cursor: pointer;
            z-index: 11;
            background: #1d1d1d;
            padding: 10px 11px;
            border-radius: 10px;
        }
        i {
            margin-right: 8px;
        }
        .logo {
            position: fixed;
            top: 10px;
            right: 10px;
            z-index: 11;
        }
        .logo img {
            width: 40px;
            border-radius: 50%;
        }
        .logout-btn {
            position: fixed;
            top: 55px;
            right: 5px;
            background-color: #1d1d1d;
            color: #e0e0e0;
            border: none;
            padding: 5px 12px;
            font-size: 12px;
            border-radius: 15px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            z-index: 11;
        }
        .logout-btn a {
            color: #e0e0e0;
            text-decoration: none;
        }
        .logout-btn:hover {
            background-color: #3a3a3a;
        }
        .loan-entry {
            padding: 10px 0;
            margin-bottom: 20px;
            border-bottom: none;
            width: 103%;
            padding-bottom: 30px;
        }
        ::-webkit-scrollbar {
            width: 10px;
        }
        .amount-buttons {
            display: flex;
            gap: 20px;
            margin: 40px 0px 0px;
            padding: 10px 15px 5px 0px;
            overflow-x: scroll;
            width: 100%;
            white-space: nowrap;
        }
        .amount-btn {
            background-color: rgb(33 33 33);
            color: #e0e0e0;
            border: none;
            padding: 10px 20px;
            font-size: 12px;
            border-radius: 10px 0px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            position: relative;
        }
        .amount-btn:hover {
            background-color: #434343;
            color: rgb(255, 255, 255);
        }
        .amount-btn.active {
            background-color: #00aef8;
            color: #000000;
        }
        .amount-btn .amount-id {
            position: absolute;
            top: -10px;
            right: 0px;
            font-size: 10px;
            color: #00aeff;
            background: #0f0f0f;
            padding: 3px 10px;
            border-radius: 0px 8px;
        }
        .notice {
            font-weight: 200;
            font-size: 12px;
            line-height: 20px;
            position: fixed;
            bottom: 60px;
            color: #ffffffd4;
            padding: 10px;
            border: solid 1.4px #9595954d;
            border-radius: 10px;
            width: 90%;
            max-width: 400px;
        }
        .powered-by {
            position: fixed;
            top: 11px;
            font-size: 10px;
            color: #000000;
            z-index: 1000;
            background: #ffffff;
            text-align: center;
            padding: 6px 15px;
            display: none;
            border-radius: 8px;
        }
        .membership-type {
            color: #00aeff;
            font-size: 14px;
            font-weight: 400;
            margin: 10px 0;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .membership-icon {
            width: 18px;
            height: 18px;
        }
        .user-icon {
            width: 25px;
            border-radius: 1000px;
        }
        p#membershipType {
            font-size: 11px;
            color: #ff66f9;
            padding: 0px;
            font-weight: 300;
        }
        .profile-container {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }
        .profile-picture {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 33px;
            font-weight: 900;
            color: #000;
            background-size: cover;
            background-position: center;
        }
        .amounts-btn {
            background-color: #ffffff;
            color: black;
            border: none;
            padding: 1px 5px;
            font-size: 10px;
            border-radius: 30px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 2px;
            margin-top: 10px;
        }
        .amounts-btn:hover {
            background-color: #ffffffd4;
        }
        .amounts-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 10000001;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .amounts-modal-content {
            background-color: #1a1a1a;
            padding: 20px;
            border-radius: 30px;
            width: 90%;
            max-width: 400px;
            color: #e0e0e0;
            position: relative;
            line-height: 42px;
        }
        .amounts-close-btn {
            position: absolute;
            top: 10px;
            right: 20px;
            color: #e0e0e0;
            font-size: 25px;
            cursor: pointer;
        }
        span#userName {
            color: white;
        }
        span {
            color: #00c6ff;
        }
    </style>
</head>
<body>
    <div id="passwordContainer">
        <h2 style="font-weight: 400; font-size: 20px; color: white;">Verify my account</h2>
        <input type="text" id="userPassword" placeholder="Enter password" autocomplete="current-password">
        <button id="submitBtn">Verify</button><br>
        <p id="error-message"></p>
        <div class="notice">
            You should return the money before the due date, If not additional interest will be charged.
        </div>
    </div>

    <div id="userInfoModal" class="modal">
        <span><i class="fa-solid fa-arrow-left close-btn" onclick="closeModal()"></i></span>
        <h3 style="text-decoration: underline; margin: 25px 0px; font-weight: 600; font-size: 15px;">Borrower</h3>
        <div class="profile-container">
            <div class="profile-picture" id="profilePicture"></div>
            <div>
                <p id="userNameContainer" style="font-size: 20px; display: flex; gap: 5px;">
                    <span style="color: white;" id="userName"></span>
                </p>
                <button class="amounts-btn" onclick="showAmountsModal()">
                    <i class="fa-solid fa-eye" style="margin-right: 2px;"></i> Amounts
                </button>
                <p id="membershipType" class="membership-type"></p>
            </div>
        </div>
        <div class="amount-buttons" id="amountButtons"></div>
        <div id="loanDetails"></div>
    </div>
    <div id="amountsModal" class="amounts-modal" style="display: none;">
        <div class="amounts-modal-content">
            <span class="amounts-close-btn" onclick="closeAmountsModal()">×</span>
            <h3 style="text-decoration: underline; margin-bottom: 5px; font-weight: 600; font-size: 22px; text-align: center; color: #8080808c;">Total Amounts</h3>
            <p><i class="fa-solid fa-money-bill"></i> Total Taken Amount: <span id="totalTaken"></span> ₹</p>
            <p><i class="fa-solid fa-arrow-up-wide-short"></i> Total Interest: <span id="totalInterest"></span> ₹</p>
            <hr>
            <p><i class="fa-solid fa-money-check-alt"></i> Total Amount to Return: <span id="totalReturn"></span> ₹</p>
        </div>
    </div>
    <div class="mfi" style="position: fixed; bottom: 10px; font-size: 10px; color: #848484; z-index: 1000; background: transparent; width: 100%; text-align: center; padding: 10px;">
        <a target="_blank" style="text-decoration: none;" href="https://mfi0212.github.io/MFI/mfimain">By Myootive</a>
    </div>
    <div class="powered-by" id="poweredBy">
        Powered by <a style="color: rgb(0, 0, 0); font-weight: 500;" href="https://blackswan19.github.io/Educate/password">BsPsgenerater</a>
    </div>
    <script>
        const passwords = {
            "4211": {
                name: "Chaitanya Harsha",
                membershipType: "Premium - Mini",
                membershipIcon: "https://cdn-icons-png.flaticon.com/512/7641/7641727.png",
                fineRate: 10,
                profileBackground: "#ff4d4d",
                loans: [
                    {
                        planDate: "24-05-2025",
                        endDate: "30-06-2025(Extended to 10 days)",
                        interest: 4500,
                        takenAmount: 15000,
                        takenFrom: "MLending"
                    },
                    {
                        planDate: "07-04-2025",
                        endDate: "30-06-2025(Extended to 10 days)",
                        interest: 6000,
                        takenAmount: 10000,
                        takenFrom: "MLLD"
                    },
                ]
            },
            "Mahesh888*": {
                name: "Mahesh Muthinti",
                membershipType: "Premium - Mini",
                membershipIcon: "https://cdn-icons-png.flaticon.com/512/7641/7641727.png",
                fineRate: 10,
                profileBackground: "#4da8ff",
                loans: [
                    {
                        planDate: "01-06-2025",
                        endDate: "21-07-2025(Extanded to 5 days)",
                        interest: 1020,
                        takenAmount: 5000,
                        takenFrom: "MLLD Offer"
                    },
                    {
                        planDate: "25-05-2025",
                        endDate: "24-07-2025(Extanded to 5 days)",
                        interest: 0,
                        takenAmount: 5000,
                        takenFrom: "MLLD"
                    },
                    {
                        planDate: "28-06-2025",
                        endDate: "02-08-2025(Extanded to 5 days)",
                        interest: 2500,
                        takenAmount: 10000,
                        takenFrom: "Delayit offer"
                    },
                ]
            },
            "Cherish@123": {
                name: "Cherish",
                membershipType: "Premium - Mini",
                membershipIcon: "https://cdn-icons-png.flaticon.com/512/7641/7641727.png",
                fineRate: 3,
                profileBackground: "#ffcc00",
                loans: [
                    {
                        planDate: "21-05-2025",
                        endDate: "30-06-2025",
                        interest: 1950,
                        takenAmount: 5000,
                        takenFrom: "MLLD"
                    },
                    {
                        planDate: "23-05-2025",
                        endDate: "01-08-2025",
                        interest: 1220,
                        takenAmount: 3500,
                        takenFrom: "MLLD"
                    },
                    {
                        planDate: "28-05-2025",
                        endDate: "01-08-2025<br>(<span style='color:yellow'>Interest cleared</span>)",
                        interest: 0,
                        takenAmount: 2000,
                        takenFrom: "MLLD"
                    },
                    {
                        planDate: "25-05-2025",
                        endDate: "01-08-2025<br>(<span style='color:yellow'>Interest cleared</span>)",
                        interest: 0,
                        takenAmount: 2500,
                        takenFrom: "MLLD(Offer)"
                    },
                    {
                        planDate: "24-05-2025",
                        endDate: "01-08-2025<br>(<span style='color:yellow'>Interest cleared</span>)",
                        interest: 0,
                        takenAmount: 3500,
                        takenFrom: "MLLD(Offer)"
                    },
                    {
                        planDate: "26-05-2025",
                        endDate: "01-08-2025<br>(<span style='color:yellow'>Interest cleared</span>)",
                        interest: 0,
                        takenAmount: 10000,
                        takenFrom: "MLending"
                    },
                    {
                        planDate: "29-05-2025",
                        endDate: "30-06-2025",
                        interest: 4800,
                        takenAmount: 15000,
                        takenFrom: "MLending"
                    },
                ]
            },
        };

        let sessionReferenceTime = null;

        document.addEventListener("DOMContentLoaded", () => {
            const savedPassword = localStorage.getItem("userPassword");
            if (savedPassword) {
                const passwordInput = document.getElementById("userPassword");
                passwordInput.value = savedPassword;
                document.getElementById("poweredBy").style.display = "block";
            }
        });

        document.getElementById("submitBtn").addEventListener("click", () => {
            const userInput = document.getElementById("userPassword").value.trim();
            const errorMessage = document.getElementById("error-message");
            const user = passwords[userInput];

            if (!userInput) {
                errorMessage.textContent = "Please enter a password.";
                return;
            }

            if (user) {
                localStorage.setItem("userPassword", userInput);
                document.getElementById("userName").textContent = user.name;
                const membershipTypeContainer = document.getElementById("membershipType");
                membershipTypeContainer.innerHTML = `
                    <a href="https://mfi0212.github.io/MFI/starpre" style="text-decoration: underline; text-underline-position: under;">${user.membershipType}</a>
                `;

                const userNameContainer = document.getElementById("userNameContainer");
                userNameContainer.innerHTML = `
                    <span id="userName">${user.name}</span>
                    <img src="${user.membershipIcon}" alt="${user.membershipType} Icon" class="user-icon">
                `;

                const profilePicture = document.getElementById("profilePicture");
                profilePicture.style.backgroundColor = user.profileBackground;
                // Generate icon from first two words (max 2 letters, uppercase)
                const nameParts = user.name.trim().split(/\s+/).slice(0, 2);
                const iconText = nameParts.map(part => part.charAt(0)).join("").toUpperCase();
                profilePicture.style.backgroundImage = "none";
                profilePicture.textContent = iconText;

                const amountButtons = document.getElementById("amountButtons");
                amountButtons.innerHTML = "";

                user.loans.forEach((loan, index) => {
                    const btn = document.createElement("button");
                    btn.className = "amount-btn";
                    btn.innerHTML = `${loan.takenAmount} Rupees <span class="amount-id">Amount ${index + 1}</span>`;
                    btn.onclick = () => displayLoanDetails(loan, index);
                    amountButtons.appendChild(btn);
                });

                if (user.loans.length > 0) {
                    displayLoanDetails(user.loans[0], 0);
                } else {
                    errorMessage.textContent = "No active loans found.";
                }

                document.getElementById("userInfoModal").style.display = "block";
                errorMessage.textContent = "";
            } else {
                errorMessage.textContent = "Invalid password.";
            }
        });

        function calculateDaysBetween(startDate, endDate) {
            try {
                const dateFormat = /^(\d{2})-(\d{2})-(\d{4})/;
                const startMatch = startDate.match(dateFormat);
                const endMatch = endDate.split('(')[0].match(dateFormat);
                if (startMatch && endMatch) {
                    const start = new Date(`${startMatch[3]}-${startMatch[2]}-${startMatch[1]}`);
                    const end = new Date(`${endMatch[3]}-${endMatch[2]}-${endMatch[1]}`);
                    if (isNaN(start) || isNaN(end)) {
                        return "Invalid date";
                    }
                    const diffTime = Math.abs(end - start);
                    return Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                }
                return "Invalid date format";
            } catch (error) {
                console.error("Error calculating days:", error);
                return "Error";
            }
        }

        function calculateOverdueFine(endDate, user) {
            try {
                const dateFormat = /^(\d{2})-(\d{2})-(\d{4})/;
                const endMatch = endDate.split('(')[0].split('<')[0].match(dateFormat);
                if (!endMatch) return { overdue: false, fine: 0, hoursOverdue: 0 };

                const end = new Date(`${endMatch[3]}-${endMatch[2]}-${endMatch[1]}`);
                end.setHours(23, 59, 59, 999);

                if (!sessionReferenceTime) {
                    sessionReferenceTime = new Date();
                }
                const now = sessionReferenceTime;

                if (now > end) {
                    const diffTime = now - end;
                    const hoursOverdue = Math.floor(diffTime / (1000 * 60 * 60));
                    const fine = hoursOverdue * user.fineRate;
                    return { overdue: true, fine: fine, hoursOverdue: hoursOverdue };
                }
                return { overdue: false, fine: 0, hoursOverdue: 0 };
            } catch (error) {
                console.error("Error calculating overdue fine:", error);
                return { overdue: false, fine: 0, hoursOverdue: 0 };
            }
        }

        function displayLoanDetails(loan, index) {
            const loanDetails = document.getElementById("loanDetails");
            const userInput = document.getElementById("userPassword").value.trim();
            const user = passwords[userInput];

            if (!loan.hasOwnProperty('cachedFine')) {
                const overdueInfo = calculateOverdueFine(loan.endDate, user);
                if (overdueInfo.overdue) {
                    user.loans[index].cachedFine = overdueInfo.fine;
                    user.loans[index].cachedHoursOverdue = overdueInfo.hoursOverdue;
                    user.loans[index].originalInterest = loan.interest;
                    user.loans[index].interest = loan.interest + overdueInfo.fine;
                    if (!loan.endDate.includes('Overdue')) {
                        user.loans[index].endDate = `${loan.endDate.split('<')[0]}<br><p style="color: red;">Overdue by ${overdueInfo.hoursOverdue} hours, additional fine added.</p>`;
                    }
                } else {
                    user.loans[index].cachedFine = 0;
                    user.loans[index].cachedHoursOverdue = 0;
                    user.loans[index].originalInterest = loan.interest;
                }
            }

            const fine = loan.cachedFine || 0;
            const originalInterest = loan.originalInterest || loan.interest;
            const totalReturnAmount = (loan.takenAmount + loan.interest).toFixed(2);
            const cleanEndDate = loan.endDate.split('(')[0].split('<')[0];
            const daysBetween = calculateDaysBetween(loan.planDate, cleanEndDate);

            document.querySelectorAll(".amount-btn").forEach(btn => btn.classList.remove("active"));
            document.getElementById("amountButtons").children[index].classList.add("active");

            loanDetails.innerHTML = `
                <div class="loan-entry">
                    <h3 style="text-decoration: underline; margin: 25px 0px; font-weight: 600; font-size: 15px;">
                        Service
                    </h3>
                    <p>${loan.takenFrom}</p>
                    <h3 style="text-decoration: underline; margin: 25px 0px; font-weight: 600; font-size: 15px;">
                        Amount Details
                    </h3>
                    <p><i class="fa-solid fa-money-bill-transfer"></i> Amount: ${loan.takenAmount} Rupees</p>
                    <h3 style="text-decoration: underline; margin: 25px 0px; font-weight: 600; font-size: 15px;">
                        Taken & Ends
                    </h3>
                    <p><i class="fa-solid fa-calendar-day"></i> Taken on: ${loan.planDate}</p>
                    <p><i class="fa-solid fa-calendar-check"></i> End on: ${loan.endDate}</p>
                    <h3 style="text-decoration: underline; margin: 25px 0px; font-weight: 600; font-size: 15px;">
                        Loan Duration
                    </h3>
                    <p><i class="fa-solid fa-clock"></i> Duration: ${daysBetween} days</p>
                    <h3 style="text-decoration: underline; margin: 25px 0px; font-weight: 600; font-size: 15px;">
                        Interest
                    </h3>
                    <p><i class="fa-solid fa-arrow-up-wide-short"></i> Normal Interest: ${originalInterest} Rupees</p>
                    <h3 style="text-decoration: underline; margin: 25px 0px; font-weight: 600; font-size: 15px;">
                        Fine
                    </h3>
                    <p><i class="fa-solid fa-exclamation-triangle"></i> Overdue Fine: ${fine} Rupees</p>
                    <h3 style="text-decoration: underline; margin: 25px 0px; font-weight: 600; font-size: 15px;">
                        Total Amount to Pay
                    </h3>
                    <p><i class="fa-solid fa-money-check-alt"></i> ${totalReturnAmount} Rupees</p>
                </div>
            `;
        }

        function showAmountsModal() {
            const userInput = document.getElementById("userPassword").value.trim();
            const user = passwords[userInput];
            if (!user) return;

            let totalTaken = 0;
            let totalInterest = 0;
            user.loans.forEach(loan => {
                totalTaken += loan.takenAmount;
                totalInterest += (loan.cachedFine || 0) + (loan.originalInterest || loan.interest);
            });
            const totalReturn = (totalTaken + totalInterest).toFixed(2);

            document.getElementById("totalTaken").textContent = totalTaken;
            document.getElementById("totalInterest").textContent = totalInterest;
            document.getElementById("totalReturn").textContent = totalReturn;

            document.getElementById("amountsModal").style.display = "flex";
        }

        function closeAmountsModal() {
            document.getElementById("amountsModal").style.display = "none";
        }

        function closeModal() {
            document.getElementById("userInfoModal").style.display = "none";
            document.getElementById("userPassword").value = "";
            sessionReferenceTime = null;
        }

        document.addEventListener("DOMContentLoaded", () => {
            const customMenu = document.querySelector(".custom-menu");

            document.addEventListener("contextmenu", (event) => {
                event.preventDefault();
                if (customMenu) {
                    customMenu.style.display = "block";
                    customMenu.style.top = `${event.pageY}px`;
                    customMenu.style.left = `${event.pageX}px`;
                }
            });

            document.addEventListener("click", () => {
                if (customMenu) {
                    customMenu.style.display = "none";
                }
            });
        });
    </script>
</body>
</html>
